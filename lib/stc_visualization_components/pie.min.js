!function(a){var b={margin:{top:2,right:2,bottom:2,left:2},sort:function(a,b){return this.getId(a).localeCompare(this.getId(b))},innerRadius:0,padding:8e-4,aspectRatio:16/9,width:600};this.pieChart=function(c,d,e){var f,g,h=a(!0,{},b,d),i=h.width,j=Math.ceil(i/h.aspectRatio),k=h.innerHeight=j-h.margin.top-h.margin.bottom,l=h.innerWidth=i-h.margin.left-h.margin.right,m=c.select("g.margin-offset"),n=m.select(".data"),o=function(a){return(a||d3.transition()).duration(1e3)},p=function(){var a,b=this.settings,c=b.filterData&&"function"==typeof b.filterData?b.filterData.call(b,e):e,d=Math.min(k,l)/2,f=b.innerRadius/2,g=function(a){return a.startAngle},h=function(a){return a.endAngle},i=function(a){return a.padAngle},j=d3.arc().startAngle(g).endAngle(h).padAngle(i).innerRadius(f).outerRadius(d),p="function"==typeof b.padding?b.padding.bind(b):b.padding||0,q=b.getValue?b.getValue.bind(b):null,r=b.getId?function(a,c,d){return b.getId.call(b,a.data,c,d)}:null,s=b.getText?b.getText.bind(b):null,t=function(){d3.select(this).select("textPath").text(w)},u=function(a,c){var d="arc arc"+(c+1);return b.getClass&&"function"==typeof b.getClass&&(d+=" "+b.getClass.call(b,a)),d},v=function(a){var b,c=this.parentNode._current,d=a;return b=d3.interpolate(c,d),this.parentNode._current=d,function(c){var d=b(c);return d.parent=a.parent,j(d)}},w=function(a,b,c){var e=c[0],f=d3.select(e.parentNode).append("tspan"),i=s.call(this,a.data,b,c),j=function(){var b,c,e,j,k,l;if(b=(h(a)-g(a))/(2*Math.PI),c=2*b*Math.PI*d-10,!i||i.length<1||c<=0)return null;if(f.text("..."),e=f.node().getComputedTextLength(),f.text(i),(j=f.node().getComputedTextLength())<c)return i;if(3*e>c)return null;for(l=j/c,k=Math.ceil(1*i.length/l);f.node().getSubStringLength(0,k)+e>c;)k--;return i.substr(0,k)+"..."}();return f.remove(),j},x=d3.pie().value(q).sort(b.sort.bind(b)).padAngle(p);n.empty()&&(n=m.append("g").attr("class","data").attr("transform","translate("+l/2+","+k/2+")")),a=n.selectAll(".arc").data(x(c),r),a.enter().append("g").attr("id",r).attr("class",u).each(function(a){var b=d3.select(this),c=function(){return b.attr("id")+"_arc"};this._current=a,b.append("path").attr("id",c).attr("d",j),b.append("text").attr("dy",15).attr("dx",5).attr("aria-hidden","true").append("textPath").attr("xlink:href",function(){return"#"+c.apply(this,arguments)}).text(w)}),a.attr("class",u).transition().each(function(){var a=o(d3.select(this).transition());a.select("text textPath").text(null),a.select("path").attrTween("d",v),a.on("end",t)}),a.exit().transition().each(function(){var a=o(d3.select(this).transition());a.select("text textPath").text(null),a.select("path").attrTween("d",v),a.on("end",function(){d3.select(this).remove()})})};return f={settings:h,svg:c},c.attr("viewBox","0 0 "+i+" "+j).attr("preserveAspectRatio","xMidYMid meet").attr("role","img").attr("aria-label",h.altText),m.empty()&&(m=c.append("g").attr("class","margin-offset").attr("transform","translate("+h.margin.left+","+h.margin.top+")")),g=function(){p.apply(f),d3.stcExt.addIEShim(c,j,i),h.datatable},void 0===e?d3.json(h.url,function(a,b){e=b,g()}):g(),f}}(jQuery.extend,jQuery);
//# sourceMappingURL=pie.min.js.map