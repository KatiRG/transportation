!function(a){var b={margin:{top:2,right:2,bottom:2,left:2},arcsWidth:20,padding:.03,aspectRatio:16/9,width:600};this.chordChart=function(c,d,e){var f,g,h=a(!0,{},b,d),i=h.width,j=Math.ceil(i/h.aspectRatio),k=h.innerHeight=j-h.margin.top-h.margin.bottom,l=h.innerWidth=i-h.margin.left-h.margin.right,m=c.select("g.margin-offset"),n=m.select(".data"),o=d3.transition().duration(1e3),p=function(){var a,b,d,f,g=this.settings,h=g.filterData&&"function"==typeof g.filterData?g.filterData.call(g,e):e,i=Math.min(k,l)/2,j=i-g.arcsWidth,p=function(a){return[a.startAngle,a.endAngle]},q=function(a){return[a.source.startAngle,a.source.endAngle,a.target.startAngle,a.target.endAngle]},r=function(a){var b=p(a),c=this.parentNode._current,d=d3.interpolate(c,b);return this.parentNode._current=b,function(a){var b=d(a);return B({startAngle:b[0],endAngle:b[1]})}},s=g.arcs&&g.arcs.getId?g.arcs.getId.bind(g):null,t=g.arcs&&g.arcs.getClass?g.arcs.getClass.bind(g):null,u=g.arcs&&g.arcs.getText?g.arcs.getText.bind(g):null,v=function(a){var b,c,d,e,f=d3.select(this),g=f.text();return""!==g?(b=f.select("textPath").remove(),f.text(g),c=this.getSubStringLength(0,g.length),f.text(null).insert(function(){return b.node()}),d=(a.endAngle-a.startAngle)/(2*Math.PI),e=2*d*Math.PI*j/2,c<e):null},w=function(){return!0===v.apply(this,arguments)?"1":"0"},x=function(a){var b=q(a),c=this.parentNode._current,d=d3.interpolate(c,b);return this.parentNode._current=b,function(a){var b=d(a);return C({source:{startAngle:b[0],endAngle:b[1]},target:{startAngle:b[2],endAngle:b[3]}})}},y=g.ribbons&&g.ribbons.getId?g.ribbons.getId.bind(g):null,z=g.ribbons?g.ribbons.getClass.bind(g):null,A=d3.chord().padAngle(g.padding),B=d3.arc().innerRadius(j).outerRadius(i),C=d3.ribbon().radius(j);g.startAngle&&(B.startAngle(g.startAngle.bind(g)),C.startAngle(g.startAngle.bind(g))),g.endAngle&&(B.endAngle(g.endAngle.bind(g)),C.endAngle(g.endAngle.bind(g))),n.empty()&&(n=m.append("g").attr("class","data").attr("transform","translate("+l/2+","+k/2+")")),n.datum(function(a){var b,c,d,e,f=A(a.matrix);for(b=0;b<f.groups.length;b++)c=f.groups[b],c.index=a.indexes[c.index];for(d=0;d<f.length;d++)e=f[d],e.source.index=a.indexes[e.source.index],e.source.subIndex=a.indexes[e.source.subIndex],e.target.index=a.indexes[e.target.index],e.target.subIndex=a.indexes[e.target.subIndex];return f}(g.getMatrix.call(g,h))),a=n.select(".arcs"),a.empty()&&(a=n.append("g").attr("class","arcs")),d=a.selectAll("g").data(function(a){return a.groups},s),b=n.select(".ribbons"),b.empty()&&(b=n.append("g").attr("class","ribbons")),f=b.selectAll("g").data(function(a){return a},y),d.enter().append("g").attr("class",t).attr("id",s).each(function(a,b){var d,e=d3.select(this),f=function(){return c.attr("id")+"arc"+b};this._current=p(a),e.append("path").attr("d",B).attr("id",f),d=e.append("text").attr("dy",15).attr("dx",5).attr("aria-hidden","true"),d.append("textPath").attr("xlink:href",function(){return"#"+f.apply(this,arguments)}).text(u),d.style("opacity",w)}),d.attr("class",t).each(function(){var a=d3.select(this);a.select("text").style("opacity",w),a.select("path").transition(o).attrTween("d",r)}),d.exit().remove(),f.enter().append("g").attr("id",y).attr("class",z).each(function(a){this._current=q(a),d3.select(this).append("path").attr("d",C)}),f.attr("class",z).each(function(){d3.select(this).select("path").transition(o).attrTween("d",x)}),f.exit().remove()};return f={settings:h,svg:c},c.attr("viewBox","0 0 "+i+" "+j).attr("preserveAspectRatio","xMidYMid meet").attr("role","img").attr("aria-label",h.altText),m.empty()&&(m=c.append("g").attr("class","margin-offset").attr("transform","translate("+h.margin.left+","+h.margin.top+")")),g=function(){p.apply(f),d3.stcExt.addIEShim(c,j,i),h.datatable},void 0===e?d3.json(h.url,function(a,b){e=b,g()}):g(),f}}(jQuery.extend,jQuery);
//# sourceMappingURL=chord.min.js.map